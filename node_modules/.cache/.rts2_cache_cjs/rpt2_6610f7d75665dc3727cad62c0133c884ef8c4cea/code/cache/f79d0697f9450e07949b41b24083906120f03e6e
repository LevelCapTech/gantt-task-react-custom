{"code":"import React, { useEffect, useMemo, useRef, useState } from \"react\";\r\nimport { resolveVisibleFields } from \"../../helpers/task-helper\";\r\nimport styles from \"./task-list-header.module.css\";\r\nimport classNames from \"classnames\";\r\nimport { getDefaultWidth, DEFAULT_MIN_WIDTH } from \"./task-list\";\r\nimport { DndContext, PointerSensor, useSensor, useSensors, } from \"@dnd-kit/core\";\r\nimport { SortableContext, arrayMove, useSortable, horizontalListSortingStrategy, } from \"@dnd-kit/sortable\";\r\nimport { CSS } from \"@dnd-kit/utilities\";\r\nexport const TaskListHeaderDefault = ({ headerHeight, fontFamily, fontSize, rowWidth, visibleFields, columnsState, setColumnsState, enableColumnDrag = true, }) => {\r\n    const labels = {\r\n        name: \"タスク名\",\r\n        start: \"開始日\",\r\n        end: \"終了日\",\r\n        process: \"工程\",\r\n        assignee: \"担当者\",\r\n        plannedStart: \"予定開始\",\r\n        plannedEnd: \"予定終了\",\r\n        plannedEffort: \"予定工数\",\r\n        actualEffort: \"実績工数\",\r\n        status: \"ステータス\",\r\n    };\r\n    const fallbackColumns = resolveVisibleFields(visibleFields).map((field) => ({\r\n        id: field,\r\n        label: labels[field],\r\n        width: getDefaultWidth(field, rowWidth),\r\n        minWidth: DEFAULT_MIN_WIDTH,\r\n        visible: true,\r\n    }));\r\n    const resolvedColumns = useMemo(() => (columnsState || fallbackColumns).filter(column => column.visible !== false), [columnsState, fallbackColumns]);\r\n    const sensors = useSensors(useSensor(PointerSensor));\r\n    const [resizingId, setResizingId] = useState(null);\r\n    const onDragEnd = (event) => {\r\n        if (!setColumnsState || !enableColumnDrag)\r\n            return;\r\n        const { active, over } = event;\r\n        if (!over || active.id === over.id)\r\n            return;\r\n        setColumnsState(prev => {\r\n            const visible = prev.filter(column => column.visible !== false);\r\n            const oldIndex = visible.findIndex(column => column.id === active.id);\r\n            const newIndex = visible.findIndex(column => column.id === over.id);\r\n            if (oldIndex < 0 || newIndex < 0)\r\n                return prev;\r\n            const moved = arrayMove(visible, oldIndex, newIndex);\r\n            let idx = 0;\r\n            return prev.map(column => column.visible !== false ? moved[idx++] : column);\r\n        });\r\n    };\r\n    const headerContent = (React.createElement(\"div\", { className: styles.ganttTable, style: {\r\n            fontFamily: fontFamily,\r\n            fontSize: fontSize,\r\n        } },\r\n        React.createElement(\"div\", { className: styles.ganttTable_Header, style: {\r\n                height: headerHeight - 2,\r\n            } }, resolvedColumns.map((column, index) => (React.createElement(React.Fragment, { key: column.id },\r\n            React.createElement(SortableHeaderItem, { column: column, labels: labels, setColumnsState: setColumnsState, enableDrag: enableColumnDrag && !!setColumnsState, setResizingId: setResizingId, isResizing: resizingId === column.id }),\r\n            index !== resolvedColumns.length - 1 && (React.createElement(\"div\", { className: styles.ganttTable_HeaderSeparator, style: {\r\n                    height: headerHeight * 0.5,\r\n                    marginTop: headerHeight * 0.2,\r\n                } }))))))));\r\n    return (React.createElement(DndContext, { sensors: sensors, onDragEnd: enableColumnDrag ? onDragEnd : undefined },\r\n        React.createElement(SortableContext, { items: resolvedColumns.map(column => column.id), strategy: horizontalListSortingStrategy }, headerContent)));\r\n};\r\nconst SortableHeaderItem = ({ column, labels, setColumnsState, enableDrag, setResizingId, isResizing }) => {\r\n    const { attributes, listeners, setNodeRef, transform, transition, isDragging, } = useSortable({\r\n        id: column.id,\r\n        disabled: !enableDrag,\r\n    });\r\n    const startXRef = useRef(null);\r\n    const startWidthRef = useRef(null);\r\n    const moveHandlerRef = useRef(null);\r\n    const upHandlerRef = useRef(null);\r\n    useEffect(() => {\r\n        return () => {\r\n            if (moveHandlerRef.current) {\r\n                document.removeEventListener(\"mousemove\", moveHandlerRef.current);\r\n                moveHandlerRef.current = null;\r\n            }\r\n            if (upHandlerRef.current) {\r\n                document.removeEventListener(\"mouseup\", upHandlerRef.current);\r\n                upHandlerRef.current = null;\r\n            }\r\n        };\r\n    }, []);\r\n    const style = {\r\n        minWidth: column.width,\r\n        maxWidth: column.width,\r\n        transform: CSS.Transform.toString(transform),\r\n        transition,\r\n    };\r\n    const onMouseDownResize = event => {\r\n        event.stopPropagation();\r\n        event.preventDefault();\r\n        startXRef.current = event.clientX;\r\n        startWidthRef.current = column.width;\r\n        setResizingId(column.id);\r\n        const handleMouseMove = (moveEvent) => {\r\n            if (startXRef.current == null || startWidthRef.current == null)\r\n                return;\r\n            const delta = moveEvent.clientX - startXRef.current;\r\n            const nextWidth = Math.max(column.minWidth, startWidthRef.current + delta);\r\n            setColumnsState?.(prev => prev.map(item => item.id === column.id ? { ...item, width: nextWidth } : item));\r\n        };\r\n        const handleMouseUp = () => {\r\n            startXRef.current = null;\r\n            startWidthRef.current = null;\r\n            setResizingId(null);\r\n            if (moveHandlerRef.current) {\r\n                document.removeEventListener(\"mousemove\", moveHandlerRef.current);\r\n                moveHandlerRef.current = null;\r\n            }\r\n            if (upHandlerRef.current) {\r\n                document.removeEventListener(\"mouseup\", upHandlerRef.current);\r\n                upHandlerRef.current = null;\r\n            }\r\n        };\r\n        moveHandlerRef.current = handleMouseMove;\r\n        upHandlerRef.current = handleMouseUp;\r\n        document.addEventListener(\"mousemove\", handleMouseMove);\r\n        document.addEventListener(\"mouseup\", handleMouseUp);\r\n    };\r\n    return (React.createElement(\"div\", { ref: setNodeRef, className: classNames(styles.ganttTable_HeaderItem, {\r\n            [styles.ganttTable_HeaderItemDragging]: isDragging,\r\n        }), style: style },\r\n        React.createElement(\"div\", Object.assign({ className: classNames(styles.ganttTable_DragHandle, {\r\n                [styles.ganttTable_DragHandleDisabled]: !enableDrag,\r\n            }) }, attributes, listeners, { \"aria-label\": \"Drag column\", onMouseDown: event => event.stopPropagation() }),\r\n            React.createElement(\"span\", { className: styles.ganttTable_DragIcon, \"aria-hidden\": \"true\" }, \"\\u22EE\\u22EE\")),\r\n        React.createElement(\"div\", { className: styles.ganttTable_HeaderLabel }, labels[column.id]),\r\n        React.createElement(\"div\", { className: classNames(styles.ganttTable_ResizeHandle, {\r\n                [styles.ganttTable_ResizeHandleActive]: isResizing,\r\n            }), onMouseDown: onMouseDownResize, \"aria-label\": \"Resize column\", role: \"separator\", \"aria-orientation\": \"vertical\" })));\r\n};\r\n//# sourceMappingURL=task-list-header.js.map","references":["/home/runner/work/gantt-task-react-custom/gantt-task-react-custom/node_modules/@types/react/ts5.0/index.d.ts","/home/runner/work/gantt-task-react-custom/gantt-task-react-custom/src/helpers/task-helper.ts","/home/runner/work/gantt-task-react-custom/gantt-task-react-custom/src/types/public-types.ts","/home/runner/work/gantt-task-react-custom/gantt-task-react-custom/node_modules/classnames/index.d.ts","/home/runner/work/gantt-task-react-custom/gantt-task-react-custom/src/components/task-list/task-list.tsx","/home/runner/work/gantt-task-react-custom/gantt-task-react-custom/node_modules/@dnd-kit/core/dist/index.d.ts","/home/runner/work/gantt-task-react-custom/gantt-task-react-custom/node_modules/@dnd-kit/sortable/dist/index.d.ts","/home/runner/work/gantt-task-react-custom/gantt-task-react-custom/node_modules/@dnd-kit/utilities/dist/index.d.ts"],"map":"{\"version\":3,\"file\":\"task-list-header.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../src/components/task-list/task-list-header.tsx\"],\"names\":[],\"mappings\":\"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\"}","dts":{"name":"/home/runner/work/gantt-task-react-custom/gantt-task-react-custom/components/task-list/task-list-header.d.ts","writeByteOrderMark":false,"text":"import React from \"react\";\r\nimport { ColumnsState, VisibleField } from \"../../types/public-types\";\r\nexport declare const TaskListHeaderDefault: React.FC<{\r\n    headerHeight: number;\r\n    rowWidth: string;\r\n    fontFamily: string;\r\n    fontSize: string;\r\n    visibleFields: VisibleField[];\r\n    columnsState?: ColumnsState;\r\n    setColumnsState?: React.Dispatch<React.SetStateAction<ColumnsState>>;\r\n    enableColumnDrag?: boolean;\r\n}>;\r\n"}}
